ArticleEditor.add("plugin","counter",{translations:{en:{counter:{words:"words",chars:"chars"}}},subscribe:{"editor.change":function(){this._count()}},start:function(){this._count()},_count:function(){var t,s=0,a=0,r=0,e=this.app.$element.val(),c=(""!==(e=this._clean(e))&&(c=e.split(/\s+/),t=e.match(/\s/g),s=c?c.length:0,r=t?t.length:0,a=e.replace(/\s+/g," ").length),{words:s,characters:a,spaces:r});this.app.broadcast("counter.count",c),this.app.statusbar.add("words",this.lang.get("counter.words")+": "+c.words),this.app.statusbar.add("chars",this.lang.get("counter.chars")+": "+c.characters)},_clean:function(t){return t=(t=(t=(t=(t=(t=t.replace(/<\/(.*?)>/gi," ")).replace(/<(.*?)>/gi,"")).replace(/\t/gi,"")).replace(/\n|\r/gi," ")).replace(/&nbsp;/g,"1")).trim(),t=this.app.utils.removeInvisibleChars(t)}});